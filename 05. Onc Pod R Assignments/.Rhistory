library(dplyr)
library(magrittr)
movies <- read.csv("http://stat.slu.edu/~speegle/_book_data/movieLensData", as.is = TRUE)
str(movies)
movies%>%
group_by(Title)%>%
summarize(meanRating=mean(Rating),numRating=n())%>%
filter(numRating>=30)%>%arrange(desc(meanRating))
movies%>%
group_by(Genres)%>%
summarize(num_rating=n())%>%
arrange(desc(num_rating))
movies%>%
filter(Genres=='Comedy|Romance')%>%
group_by(Title)%>%
summarize(num_rating=n(),mean_rating=mean(Rating))%>%
filter(num_rating>=75)%>%
arrange(mean_rating)
movies%>%
group_by(Title)%>%
summarize(num_rating=n(),mean_rating=mean(Rating))%>%
filter(mean_rating>=4.0)%>%
arrange(desc(num_rating))
movies%>%
group_by(UserID)%>%
summarize(user_mean_rating=mean(Rating))%>%
arrange(desc(user_mean_rating))
require(Lahman)
str(Batting)
str(Pitching)
?Batting #data description
unique(Batting$HBP)
left_join((Batting%>%
group_by(playerID)%>%
summarize(count_HBP=sum(HBP,na.rm=TRUE))%>%
arrange(desc(count_HBP))
)[1,],select(Master,playerID,nameFirst,nameLast),by="playerID")
Batting%>%
group_by(yearID)%>%
summarize(double_count=sum(X2B, na.rm=TRUE))
Batting%>%
group_by(teamID)%>%
summarize(home_runs_count=sum(HR, na.rm=TRUE))%>%
arrange(desc(home_runs_count))
left_join((Batting%>%
group_by(playerID)%>%
summarize(count_games=sum(G),count_runs=sum(R))%>%
filter(count_games>=500)%>%
mutate(average_runs_per_game=count_runs/count_games)%>%
arrange(desc(average_runs_per_game)))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
left_join((Batting%>%
group_by(playerID)%>%
summarise(home_runs=sum(HR),at_bats=sum(AB))%>%
filter(home_runs==0)%>%
arrange(desc(at_bats)))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
left_join((Batting%>%
filter(yearID==2015)%>%
group_by(playerID)%>%
summarise(home_runs=sum(HR),at_bats=sum(AB))%>%
filter(home_runs==0)%>%
arrange(desc(at_bats)))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
left_join((Batting%>%
filter(yearID>=1960)%>%
group_by(playerID,yearID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(desc(num_triples)))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
temp=toString(
(Batting%>%
group_by(playerID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(desc(num_triples))%>%
select(playerID))[1,])
left_join((Batting%>%
filter(playerID==temp)%>%
group_by(playerID,yearID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(num_triples)%>%
top_n(1,yearID))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
temp=Batting%>%
group_by(playerID,yearID)%>%
summarise(SB_count=sum(SB))%>%
filter(!is.na(SB_count) & SB_count>0)%>%
arrange(yearID,desc(SB_count))%>%
ungroup()%>%
mutate(year=as.numeric(yearID))
temp
temp$year=as.numeric(temp$yearID,length="0L")
unique(select(temp,"year","SB_count"))%>%
group_by(year)%>%
arrange(desc(SB_count))%>%
mutate(rank=dense_rank(-SB_count)) %>%
arrange(year)%>%
filter(rank<3)%>%
spread(rank,SB_count)%>%
filter(!is.na(1)&!is.na(2))%>%
set_colnames(c("year", "rank_1", "rank_2"))%>%
mutate(SB_diff=rank_1-rank_2)%>%
arrange(desc(SB_diff))
library(magrittr)
unique(select(temp,"year","SB_count"))%>%
group_by(year)%>%
arrange(desc(SB_count))%>%
mutate(rank=dense_rank(-SB_count)) %>%
arrange(year)%>%
filter(rank<3)%>%
spread(rank,SB_count)%>%
filter(!is.na(1)&!is.na(2))%>%
set_colnames(c("year", "rank_1", "rank_2"))%>%
mutate(SB_diff=rank_1-rank_2)%>%
arrange(desc(SB_diff))
library(tidyr)
temp
temp$year=as.numeric(temp$yearID,length="0L")
unique(select(temp,"year","SB_count"))%>%
group_by(year)%>%
arrange(desc(SB_count))%>%
mutate(rank=dense_rank(-SB_count)) %>%
arrange(year)%>%
filter(rank<3)%>%
spread(rank,SB_count)%>%
filter(!is.na(1)&!is.na(2))%>%
set_colnames(c("year", "rank_1", "rank_2"))%>%
mutate(SB_diff=rank_1-rank_2)%>%
arrange(desc(SB_diff))
temp=toString(
(Batting%>%
group_by(playerID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(desc(num_triples))%>%
select(playerID))[1,])
left_join((Batting%>%
filter(playerID==temp)%>%
group_by(playerID,yearID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(num_triples)%>%
top_n(1,yearID))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
temp
temp
left_join((Batting%>%
filter(playerID==temp)%>%
group_by(playerID,yearID)%>%
summarize(num_triples=sum(X3B))%>%
arrange(num_triples)%>%
top_n(1,yearID))[1,],
select(Master,playerID,nameFirst,nameLast),by="playerID")
temp=Batting%>%
group_by(playerID,yearID)%>%
summarise(SB_count=sum(SB))%>%
filter(!is.na(SB_count) & SB_count>0)%>%
arrange(yearID,desc(SB_count))%>%
ungroup()%>%
mutate(year=as.numeric(yearID))
library(tidyr)
temp
unique(select(temp,"year","SB_count"))%>%
group_by(year)%>%
arrange(desc(SB_count))%>%
mutate(rank=dense_rank(-SB_count)) %>%
arrange(year)%>%
filter(rank<3)%>%
spread(rank,SB_count)%>%
filter(!is.na(1)&!is.na(2))%>%
set_colnames(c("year", "rank_1", "rank_2"))%>%
mutate(SB_diff=rank_1-rank_2)%>%
arrange(desc(SB_diff))
movies%>%
group_by(Title)%>%
summarize(meanRating=mean(Rating),numRating=n())%>%
filter(numRating>=30)%>%arrange(desc(meanRating))
